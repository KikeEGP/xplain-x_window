<!doctype html>
<html>
<head>
	<meta charset=utf8>
	<title>Region Demos</title>
	<link rel="stylesheet" href="demo.css">
</head>
<body class="region-demo">
	<script src="region.js"></script>
	<script>
	function drawRegion(ctx, region) {
		region.forEach(function(r) {
			ctx.fillRect(r.x, r.y, r.width, r.height);	
		});
	}
	</script>
	<h2>Region Scanning</h2>
	<canvas id="scan_in" width=200 height=200></canvas>
	<canvas id="scan_out" width=200 height=200></canvas>
	<script>
	(function() {
		function drawCircle(ctx) {
			ctx.save();
			ctx.beginPath();
			ctx.fillStyle = '#000000';
			ctx.arc(100, 100, 90, 0, Math.PI*2);
			ctx.fill();
			ctx.restore();
		}
		var ctx_in = document.getElementById("scan_in").getContext("2d");
		drawCircle(ctx_in);

		var region = scanRegion(ctx_in);

		var ctx_out = document.getElementById("scan_out").getContext("2d");
		drawRegion(ctx_out, region);

		var bounds = regionBounds(region);
		ctx_out.strokeStyle = '#ff0000';
		ctx_out.strokeRect(bounds.x, bounds.y, bounds.width, bounds.height);
	})();
	</script>

	<script>
	var regionTest = (function() {
		function makeCanvas() {
			var canvas = document.createElement("canvas");
			canvas.width = 200;
			canvas.height = 200;
			return canvas;			
		}

		function circleRegion(off) {
			var canvas = makeCanvas();
			var ctx = canvas.getContext('2d');

			ctx.save();
			ctx.beginPath();
			ctx.fillStyle = '#000000';
			ctx.arc(off, off, 60, 0, Math.PI*2);
			ctx.fill();
			ctx.restore();

			return scanRegion(ctx);
		}

		var r1 = circleRegion(80);
		var r2 = circleRegion(120);

		return function regionTest(node, func) {
			var canvas = makeCanvas();
			var ctx = canvas.getContext('2d');
			drawRegion(ctx, func(r1, r2));
			node.appendChild(canvas);
		};
	})();
	</script>

	<table>
		<tr>
			<td><h2>Region Union</h2></td>
			<td><h2>Region Subtraction</h2></td>
			<td><h2>Region Intersection</h2></td>
			<td><h2>Region Exclusion</h2></td>
		</tr>
		<tr>
			<td id="union-test"></td>
			<td id="subtract-test"></td>
			<td id="intersect-test"></td>
			<td id="exclude-test"></td>
		</tr>
	</table>
	<script>
	['union', 'subtract', 'intersect', 'exclude'].forEach(function(op) {
		var func = window[op + 'Region'];
		var node = document.getElementById(op + '-test');
		regionTest(node, func);
			});
	</script>
</body>
</html>
